<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="è¤šæ™“é€¸">
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>djangoå¼€å‘å®æˆ˜ - å­¦ä¹ ç¬”è®°</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/purebasic.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="..">å­¦ä¹ ç¬”è®°</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="..">ç›®å½•</a>
                            </li>
                            <li >
                                <a href="../daily_problem/">æ—¥å¸¸é—®é¢˜</a>
                            </li>
                            <li class="active">
                                <a href="./">djangoå¼€å‘å®æˆ˜</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">django-rest-frameworkå­¦ä¹ ç¬”è®° <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../django_rest_framework/djang_rest_framework/">Serialization</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../daily_problem/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../django_rest_framework/djang_rest_framework/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/ChuXiaoYi/edit/master/docs/django.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#ps">pä¸ªå¤§sï¼š</a></li>
        <li class="main "><a href="#django">ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„djangoé¡¹ç›®</a></li>
        <li class="main "><a href="#_1">é¡¹ç›®æ­£å¼å¼€å§‹</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h3 id="ps">pä¸ªå¤§sï¼š</h3>
<p>è¿™é‡Œç”¨çš„æ˜¯python3.7å’ŒDjango2.0.å‡è®¾å…¨éƒ½å®‰è£…æˆåŠŸ= =
ç„¶åè¿™ä¸ªæ˜¯æˆ‘åšä¸ªäººç½‘ç«™çš„ä¸€ä¸ªè¿‡ç¨‹=ã€‚=
ç„¶åè¿™ä¸ªä¹Ÿä¸èƒ½ç®—æ˜¯ä¸ªæ•™ç¨‹å§=ã€‚=
ç„¶åè¿™åªæ˜¯ç²—ç³™çš„è®°å½•=ã€‚=
æœ€åï¼Œé˜²è„±å‘ç”¨éœ¸ç‹=3=</p>
<h3 id="django">ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„djangoé¡¹ç›®</h3>
<ul>
<li><strong>åˆ›å»ºDjangoé¡¹ç›®</strong></li>
</ul>
<pre><code>django-admin.py startproject MySite
</code></pre>

<p>æ­¤æ—¶ï¼Œä½ ä¼šçœ‹åˆ°è¿™æ ·çš„æ–‡ä»¶å¤¹ï¼š
<img alt="image_1cjvd08ra1bil15seqb71p312or9.png-6.5kB" src="http://static.zybuluo.com/chuxiaoyi/49h3i95aw0oqoecmvefqd8l1/image_1cjvd08ra1bil15seqb71p312or9.png" /></p>
<ul>
<li><strong>è¿è¡Œä¸€ä¸‹ä½ çš„é¡¹ç›®ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æˆåŠŸ</strong>ï¼š</li>
</ul>
<pre><code>./manage.py runserver
</code></pre>

<p>ç»ˆç«¯ä¼šæ˜¾ç¤ºè¿™äº›ï¼š
<img alt="image_1cjvd8tjj4aq48ihk21n4d1b38m.png-79kB" src="http://static.zybuluo.com/chuxiaoyi/i4gc0elqc605ajy3f3vf69n8/image_1cjvd8tjj4aq48ihk21n4d1b38m.png" />
æœ‰çº¢å­—ä¹Ÿä¸è¦æ‹…å¿ƒï¼Œå› ä¸ºè¿˜æ²¡æœ‰è®¾ç½®å‘¢ï¼
æ¥ä¸‹æ¥å»<code>http://127.0.0.1:8000/</code>çœ‹ä¸€çœ‹ï¼š
<img alt="image_1cjvdb63b1bcl1jnpupct2610j423.png-121.7kB" src="http://static.zybuluo.com/chuxiaoyi/n2ym6tgwxd9plj2uhzugpaxi/image_1cjvdb63b1bcl1jnpupct2610j423.png" />
æˆåŠŸäº†ï¼
<font color='red'><strong>psï¼š</strong></font>å¦‚æœæƒ³è¦å¤–éƒ¨æœºå™¨ï¼ˆåŒä¸€ç½‘ç»œï¼‰è®¿é—®æœ¬æœºçš„DjangoæœåŠ¡çš„è¯ï¼Œè¦å†™æˆ<code>./manage.py runserver 0.0.0.0:9999</code>,å¹¶å°†<code>setting.py</code>ä¸­çš„<code>ALLOWED_HOSTS</code>æ”¹ä¸º<code>ALLOWED_HOSTS = ['*', ]</code>ï¼Œä¸€å®šè¦åŠ <strong>é€—å·</strong>ï¼
- <strong>æ”¹ä¸€äº›é…ç½®</strong>
<strong>ps</strong>ï¼šè¿™é‡Œçš„é¡ºåºå¯èƒ½ä¸å¯¹ã€‚= =
1. æ›´æ”¹<code>/MySite/MySite/settings.py</code>ä¸­çš„å†…å®¹
  Djangoé»˜è®¤çš„<code>DATABASES</code>æ˜¯<code>sqlite</code>ï¼Œæ˜¯è¿™æ ·çš„ï¼š
  <img alt="image_1cjvdpm002a81skaf2714pr1f2t2g.png-13.3kB" src="http://static.zybuluo.com/chuxiaoyi/v5k5xmi0xg796sduhoai22xt/image_1cjvdpm002a81skaf2714pr1f2t2g.png" />
  è¿™é‡Œæˆ‘æ˜¯ç”¨çš„æ˜¯<code>MySQL</code>æ•°æ®åº“ï¼Œå› æ­¤ï¼Œæˆ‘è¦æ”¹æˆè¿™æ ·ï¼š</p>
<pre><code>```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'MySite',
        'USER': 'xxx',
        'PASSWORD': 'xxxxx',
        'HOST': '127.0.0.1',
        'PORT': '3306'
    }
}
```
</code></pre>
<p><font color='red'>è¿™é‡Œä¸€å®šè¦ç¡®ä¿æ•°æ®åº“å·²ç»å­˜åœ¨äº†ã€‚</font>åœ¨è¿™ä¹‹å‰ï¼Œéœ€è¦åˆ›å»ºæ•°æ®åº“ï¼Œåƒè¿™æ ·æ»´ï¼š</p>
<pre><code>create database MySite CHARACTER SET utf8 COLLATE utf8_general_ci;
</code></pre>

<p>è¿˜è¦æ›´æ”¹<strong>æ—¶åŒº</strong>å’Œ<strong>è¯­è¨€</strong>
    <img alt="image_1cjveevfspif39o6hm2mnucn3d.png-5.8kB" src="http://static.zybuluo.com/chuxiaoyi/t8bc491f1uw4z71ij3vplcb1/image_1cjveevfspif39o6hm2mnucn3d.png" /></p>
<ol>
<li>
<p>å‘<code>/MySite/MySite/__init__.py</code>ä¸­æ·»åŠ å†…å®¹
 <code>python
 import pymysql
 pymysql.install_as_MySQLdb()</code></p>
</li>
<li>
<p><strong>æ•°æ®åº“è¿ç§»</strong>
é¦–å…ˆï¼Œæ‰§è¡Œ</p>
</li>
</ol>
<pre><code>./manage.py makemigrations
</code></pre>

<p>ç„¶åï¼Œæ‰§è¡Œ</p>
<pre><code>./manage.py migrate
</code></pre>

<p>è¿™æ ·å°±æˆåŠŸå•¦ï½
<img alt="image_1cjvfbgkulc0gvt1gl9cu01sgd4a.png-70.9kB" src="http://static.zybuluo.com/chuxiaoyi/ekq7zlcwi70z8znyr2jy1now/image_1cjvfbgkulc0gvt1gl9cu01sgd4a.png" /></p>
<ul>
<li><strong>åˆ›å»ºè¶…çº§ç”¨æˆ·</strong>
åˆ›å»ºè¶…çº§ç”¨æˆ·æ˜¯ç”¨æ¥ç™»é™†åˆ°adminåå°ç®¡ç†ä¸­çš„
æ‰§è¡Œ</li>
</ul>
<pre><code>./manage.py createsuperuser
</code></pre>

<p>ç„¶åæŒ‰ç…§æç¤ºå¡«å†™å°±å¥½å•¦ï½
<strong>psï¼š</strong>ä¸€å®šè¦å…ˆè¿›è¡Œæ•°æ®åº“è¿ç§»ï¼Œå†åˆ›å»ºç”¨æˆ·ã€‚å¦åˆ™ï¼Œä¼šå‡ºç°<img alt="image_1cjvfv00s1kuo119k1t8dh581ug84n.png-6.3kB" src="http://static.zybuluo.com/chuxiaoyi/du4zwcl0gkr8x9jc5o7vhpm1/image_1cjvfv00s1kuo119k1t8dh581ug84n.png" /></p>
<ul>
<li><strong>è¿›å…¥adminçœ‹çœ‹</strong>
åœ¨æµè§ˆå™¨ä¸­è¾“å…¥<code>http://127.0.0.1:8000/admin</code>ï¼Œä¼šå‡ºç°ç™»å½•é¡µé¢ï¼Œæ­¤æ—¶ä¼šå‘ç°å…¨éƒ½å˜æˆä¸­æ–‡äº†ï¼Œè¯´æ˜ä¹‹å‰çš„è®¾ç½®ç”Ÿæ•ˆäº†ã€‚
<img alt="image_1cjvg4n791bobtht1smbf1f1u7t54.png-41.6kB" src="http://static.zybuluo.com/chuxiaoyi/tfogy4umjmduw5t0utatz3o2/image_1cjvg4n791bobtht1smbf1f1u7t54.png" />
æ¥ä¸‹æ¥ï¼Œå°±å¯ä»¥ç”¨åˆšåˆšåˆ›å»ºçš„ç”¨æˆ·ç™»é™†äº†ï¼ŒæŸ¥çœ‹åå°æ•°æ®äº†ï¼</li>
</ul>
<h3 id="_1">é¡¹ç›®æ­£å¼å¼€å§‹</h3>
<ul>
<li><strong>åˆ›å»ºapp</strong>
æ‰§è¡Œ<code>./manage.py startapp Post</code>,æŸ¥çœ‹é¡¹ç›®ç»“æ„ï¼Œå¦‚ä¸‹ï¼š
<img alt="image_1cjvibkvpei29mk1doucvv12j15h.png-10kB" src="http://static.zybuluo.com/chuxiaoyi/gmgmt3mz41l9swzbv1axotyg/image_1cjvibkvpei29mk1doucvv12j15h.png" /></li>
</ul>
<p>å®Œæˆä¸Šæ­¥æ“ä½œåï¼Œéœ€è¦åœ¨<code>/MySite/MySite/settings.py</code>ä¸­å°†appæ·»åŠ è¿›å»ï¼š
<img alt="image_1cjvifci91ss01v9l1l1g1m5moo25u.png-14.5kB" src="http://static.zybuluo.com/chuxiaoyi/cqlxbmom3dcu4sskz3s9jkd8/image_1cjvifci91ss01v9l1l1g1m5moo25u.png" />
æ¥ä¸‹æ¥ï¼Œéœ€è¦åœ¨appæ–‡ä»¶å¤¹ä¸‹æ·»åŠ <code>urls.py</code>ï¼Œç”¨äºè·¯ç”±æ˜ å°„ï¼š
<img alt="image_1cjvilv4o14lf9a9371jkjhcr7o.png-9.4kB" src="http://static.zybuluo.com/chuxiaoyi/wv0tgog0pl8u2q8zcoq112um/image_1cjvilv4o14lf9a9371jkjhcr7o.png" />
åœ¨<code>urls.py</code>ä¸­è¿™æ ·å†™ï¼š</p>
<pre><code class="python">app_name = 'Post'   # è¿™é‡Œæ˜¯ä¸ºäº†urlåå‘è§£æç”¨

urlpatterns = [
    # è¿™é‡Œæ”¾æ˜ å°„çš„view
]
</code></pre>

<p>åŒæ—¶ï¼Œåœ¨<code>/MySite/MySite/urls.py</code>ä¸­éœ€è¦æ·»åŠ å¯¹<code>Post.urls</code>çš„æ˜ å°„ï¼š</p>
<pre><code class="python">from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path(r'', include('Post.urls')),
]
</code></pre>

<ul>
<li><strong>åˆ›å»ºæ¨¡å‹</strong>
åœ¨appä¸‹çš„<code>models.py</code>åˆ›å»ºè‡ªå·±çš„æ¨¡å‹å°±å¯ä»¥å•¦~</li>
</ul>
<pre><code class="python">from django.db import models

class Category(models.Model):
    &quot;&quot;&quot;åˆ†ç±»&quot;&quot;&quot;
    name = models.CharField(max_length=100)


class Tag(models.Model):
    &quot;&quot;&quot;æ ‡ç­¾&quot;&quot;&quot;
    name = models.CharField(max_length=100)


class Post(models.Model):
    &quot;&quot;&quot;æ–‡ç« &quot;&quot;&quot;
    title = models.CharField(max_length=100)
    body = models.TextField()
    created_time = models.DateTimeField()
    modified_time = models.DateTimeField()
    excerpt = models.CharField(max_length=200, blank=True)  # æ–‡ç« æ‘˜è¦ï¼Œå¯ä¸ºç©º
    category = models.ForeignKey(Category, on_delete=True)  # ForeignKeyè¡¨ç¤º1å¯¹å¤šï¼ˆå¤šä¸ªpostå¯¹åº”1ä¸ªcategoryï¼‰
    tags = models.ManyToManyField(Tag, blank=True)
    views = models.PositiveIntegerField(default=0)  # é˜…è¯»é‡
</code></pre>

<p><font color='red'>ç„¶åä¸€å®šä¸è¦å¿˜è®°å†è¿›è¡Œ<strong>æ•°æ®åº“è¿ç§»</strong>å•Šï¼ï¼</font></p>
<ul>
<li><strong>å‰ç«¯æ¨¡ç‰ˆ</strong>
è¿™é‡Œçš„å‰ç«¯æ¨¡æ¿ä½¿ç”¨çš„æ˜¯æ¨¡æ¿ä¹‹å®¶çš„
é“¾æ¥ğŸ”—ï¼šhttp://www.cssmoban.com/tags.asp?n=html5</li>
</ul>
<p>é¦–å…ˆåˆ›å»ºtemplatesç›®å½•ï¼Œç»“æ„å¦‚ä¸‹ï¼š
<img alt="image_1cjvlp6q840k17eg1cubd8i1qpi8i.png-12.8kB" src="http://static.zybuluo.com/chuxiaoyi/clj4spcx26385unz62hwxg26/image_1cjvlp6q840k17eg1cubd8i1qpi8i.png" />
æ­¤æ—¶ï¼Œéœ€è¦åœ¨<code>setting.py</code>ä¸­æ·»åŠ å…³äºæ¨¡æ¿çš„é…ç½®ï¼š
<img alt="image_1cjvls24ohf91gngccsuk5ce8v.png-39.8kB" src="http://static.zybuluo.com/chuxiaoyi/qp8cowqr7rlu64tu0znzihgn/image_1cjvls24ohf91gngccsuk5ce8v.png" /></p>
<p>æ¥ä¸‹æ¥æ˜¯staticç›®å½•ï¼Œç»“æ„å¦‚ä¸‹ï¼š
<img alt="image_1cjvlvc96ir9hk4ubn1jk73uq9c.png-9.5kB" src="http://static.zybuluo.com/chuxiaoyi/gfdqcztquhucuf7urxraech7/image_1cjvlvc96ir9hk4ubn1jk73uq9c.png" />
æ˜¾è€Œæ˜“è§ï¼Œè¿™é‡Œæ”¾çš„æ˜¯ä¸€äº›cssã€jsæ–‡ä»¶ç­‰</p>
<ul>
<li><strong>indexè§†å›¾</strong>
é¦–å…ˆï¼Œåœ¨<code>Post/views.py</code>ä¸­å®ç°<code>index</code>æ–¹æ³•ï¼š</li>
</ul>
<pre><code class="python">def index(request):
    &quot;&quot;&quot;
    ä¸»é¡µ
    :param request:
    :return:
    &quot;&quot;&quot;
    return render(request=request, template_name='Post/index.html')
</code></pre>

<p><code>request</code>ä¸ºè¯·æ±‚å¯¹è±¡;
<code>template_name</code>ä¸ºæ¸²æŸ“çš„å‰ç«¯é¡µé¢çš„è·¯å¾„å­—ç¬¦ä¸²ï¼ˆç›¸å¯¹templatesç›®å½•ï¼‰</p>
<p>ç„¶åï¼Œåœ¨<code>Post/urls.py</code>ä¸­è¿›è¡Œè·¯ç”±æ˜ å°„ï¼š</p>
<pre><code class="python">urlpatterns = [
    url(r'^$', views.index, name=&quot;index&quot;),
]
</code></pre>

<p><font color='red'>æ³¨æ„ï¼šå¦‚æœä½ ä¸»é¡µçš„urlæ˜¯ç©ºï¼Œæ­£åˆ™å¿…é¡»å†™æˆ<strong>^$</strong></font></p>
<p>æœ€åï¼Œä¸€å®šè¦è¦ä¿®æ”¹é™æ€é¡µé¢ä¸­å¼•ç”¨çš„è·¯å¾„ã€‚
å¯¹äºDjangoæ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨<code>static</code>æ ‡ç­¾ã€‚
åœ¨é¡µé¢å¼€å¤´å¼•å…¥<code>{% load static %}</code>ï¼Œè¿™ä¸ªå¯¹åº”çš„é…ç½®ä¿¡æ¯æ˜¯<img alt="image_1ck6k15rg1j1lfei3j1aoepvha9.png-2.7kB" src="http://static.zybuluo.com/chuxiaoyi/1oihspdgm87u6fs8xsyi7rs3/image_1ck6k15rg1j1lfei3j1aoepvha9.png" />
å¹¶å°†é¡µé¢ä¸­çš„è·¯å¾„æ”¹ä¸º<img alt="image_1ck6k35as1gm97pr1gng1ch41ns7am.png-4.5kB" src="http://static.zybuluo.com/chuxiaoyi/yij56j7cs2lce5bzsd4d4mdp/image_1ck6k35as1gm97pr1gng1ch41ns7am.png" />
<font color='red'><strong>psï¼š</strong></font>å¯¹äºcssæˆ–è€…jsä¸­çš„å¼•ç”¨ä¹Ÿä¸è¦å¿˜äº†æ”¹ï¼</p>
<p>è¿è¡Œä¸€ä¸‹ã€‚
<img alt="image_1ck6k74sv5p3212h1osclqub3.png-422.3kB" src="http://static.zybuluo.com/chuxiaoyi/d5dremlh2i930xisccmz8d62/image_1ck6k74sv5p3212h1osclqub3.png" />
æå®šï¼</p>
<ul>
<li><strong>å‘å‰ç«¯æ¸²æŸ“åŠåˆ†é¡µ</strong>
é¦–å…ˆï¼Œæ›´æ”¹<code>index()</code></li>
</ul>
<pre><code class="python">from django.shortcuts import render
from django.core.paginator import Paginator
from .models import Post


def index(request):
    &quot;&quot;&quot;
    ä¸»é¡µ
    :param request:
    :return:
    &quot;&quot;&quot;

    post = Post.objects.all()

    limit = 3
    paginator = Paginator(post, limit)
    page = request.GET.get('page', 1)

    result = paginator.page(page)
    context = {
        &quot;post_list&quot;: result,
        &quot;page&quot;: page
    }
    return render(request=request, template_name='Post/index.html', context=context)
</code></pre>

<p>ç„¶åä¿®æ”¹<code>index.html</code>
<img alt="image_1ck6ueleqhgg1ml215qg8461hpkbg.png-122kB" src="http://static.zybuluo.com/chuxiaoyi/y1tnpxlnteb4sdpfe39lh6hh/image_1ck6ueleqhgg1ml215qg8461hpkbg.png" /></p>
<p>è¿è¡Œçœ‹ä¸€ä¸‹
<img alt="image_1ck6uhi34mt1nqi1a3i46p204bt.png-173.5kB" src="http://static.zybuluo.com/chuxiaoyi/rl9rr4j86xh9eqzlhuk8vm2u/image_1ck6uhi34mt1nqi1a3i46p204bt.png" />
æå®šï¼</p>
<ul>
<li><strong>æ›´æ”¹index.htmlä¸­çš„æ‰€æœ‰è·³è½¬é“¾æ¥</strong>
åœ¨è¿™é‡Œï¼Œæˆ‘ç”¨çš„æ˜¯urlçš„åå‘è§£æã€‚è¿™æ ·å¯ä»¥å‡è½»åæœŸç»´æŠ¤æˆæœ¬ã€‚å› æ­¤ï¼Œå°±éœ€è¦åœ¨urls.pyä¸­æ·»åŠ å¦‚ä¸‹ä¿¡æ¯ï¼š
<img alt="image_1ck6vajq31hn72jkr4hjpe1dt1ca.png-11.1kB" src="http://static.zybuluo.com/chuxiaoyi/xb662pip3z8x1271lcahbb35/image_1ck6vajq31hn72jkr4hjpe1dt1ca.png" /></li>
</ul>
<p><img alt="image_1ck6vb9cieha182n1eg12rt7qfcn.png-7.8kB" src="http://static.zybuluo.com/chuxiaoyi/mrayby38anpbctc28d2dmf3q/image_1ck6vb9cieha182n1eg12rt7qfcn.png" />
åœ¨htmlä¸­ä¿®æ”¹æˆå¦‚ä¸‹ï¼š
<img alt="image_1ck6vcgaqlpe8dqsf8qnn17rndk.png-3.5kB" src="http://static.zybuluo.com/chuxiaoyi/gz98bcgfeuyk3wl41rrswsi0/image_1ck6vcgaqlpe8dqsf8qnn17rndk.png" /></p>
<ul>
<li><strong>åšå®¢æ–‡ç« é¡µé¢</strong>
åˆ«å¿˜äº†æ”¹è·³è½¬é“¾æ¥ï¼ï¼ï¼ï¼
æ–‡ç« è¯¦æƒ…é¡µå’Œä¸»é¡µå¤§ä½“ç»“æ„æ˜¯ç›¸ä¼¼çš„ï¼Œå› æ­¤ï¼Œè¿™é‡Œä½¿ç”¨äº†æ¨¡ç‰ˆç»§æ‰¿ã€‚
åœ¨åŸºç±»æ¨¡ç‰ˆé‡Œï¼Œä½¿ç”¨è¿™ä¸ªï¼Œå°†å­ç±»æ¨¡ç‰ˆéœ€è¦å¡«å……çš„ä½ç½®å ä½
<img alt="image_1ck99cgjpsqtjq41hnk148j1ak9.png-4.6kB" src="http://static.zybuluo.com/chuxiaoyi/49j3eahshzer64j9h6nqpuoj/image_1ck99cgjpsqtjq41hnk148j1ak9.png" />
ç„¶ååœ¨å­ç±»æ¨¡æ¿ä¸­ï¼Œä½¿ç”¨ç›¸åŒçš„æ ‡ç­¾å°†å¡«å……çš„å†…å®¹è¿›è¡ŒåŒ…è£¹
æœ€åï¼Œä¸è¦å¿˜äº†åœ¨å­ç±»æ¨¡æ¿ä¸­å†å†™ä¸Š<code>{% extends 'Post/base.html' %}</code>å’Œ<code>{% load static %}</code></li>
</ul>
<p>åœ¨<code>Post/urls.py</code>ä¸­æ·»åŠ è¯¦æƒ…é¡µçš„urlï¼š</p>
<pre><code>url(r'^detail/post-(?P&lt;pk&gt;\d+)$', views.detail, name=&quot;detail&quot;),
</code></pre>

<p>å¹¶æ·»åŠ detailè§†å›¾</p>
<pre><code class="python">def detail(request, pk):
&quot;&quot;&quot;
:param request: 
:param pk: æ¥æ”¶åˆ°çš„æ–‡ç« çš„ä¸»é”®id
:return: 
&quot;&quot;&quot;
return render(request, template_name='Post/blog.html', )
</code></pre>

<p>è¿è¡Œçœ‹ä¸€ä¸‹å§ï¼
<img alt="image_1ck99kovo16t218tb11lo19k441mm.png-257kB" src="http://static.zybuluo.com/chuxiaoyi/y4kk578e16p5tyeiyd7mhecl/image_1ck99kovo16t218tb11lo19k441mm.png" />
æå®šï¼
ç»§ç»­åœ¨è§†å›¾ä¸­æ·»åŠ å†…å®¹ï¼Œå°†å‡æ•°æ®æ”¹ä¸ºçœŸå®çš„æ–‡ç« æ•°æ®
å¯¹äºå¤šå¯¹å¤šçš„å…³ç³»æ¥è¯´ï¼Œå¯ä»¥å†™æˆè¿™æ ·ï¼š
<img alt="image_1ck9hp2bkhnqamtcnbbm415813.png-10.1kB" src="http://static.zybuluo.com/chuxiaoyi/rnf7dr6w65lrn908p5f73rfu/image_1ck9hp2bkhnqamtcnbbm415813.png" />
çœ‹ä¸€çœ‹æ•ˆæœå§ï¼
<img alt="image_1ck9i8vcll104c16qd1i9r2k01g.png-264.3kB" src="http://static.zybuluo.com/chuxiaoyi/iplx5zoz3up0mlsm7k75j2ie/image_1ck9i8vcll104c16qd1i9r2k01g.png" /></p>
<p><font color='red'><strong>æ¥ä¸‹æ¥å°±æ˜¯è®©æˆ‘å¯ä»¥ä¸Šä¼ markdownæ ¼å¼çš„æ–‡æœ¬äº†ï¼
è¿™ä¸ªæš‚æ—¶å…ˆä¸è§£å†³äº†= =ï¼Œå°æœ¬æœ¬è®°ä¸‹æ¥</strong></font></p>
<ul>
<li><strong>æ·»åŠ åˆ†ç±»æ </strong>
è¿™é‡Œä½¿ç”¨è‡ªå®šä¹‰æ¨¡ç‰ˆæ ‡ç­¾ï¼
é¦–å…ˆï¼Œåœ¨appæ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»º<code>templatetags</code>æ–‡ä»¶å¤¹ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªpyæ–‡ä»¶ï¼Œé‡Œé¢å®šä¹‰æ¨¡ç‰ˆæ ‡ç­¾ï¼Œç›®å½•æ˜¯è¿™æ ·æ»´ï¼š
<img alt="image_1ckc3ee0n117f10is15k8idd402d.png-9.9kB" src="http://static.zybuluo.com/chuxiaoyi/el867o3qwzqlek2v3f39bn9z/image_1ckc3ee0n117f10is15k8idd402d.png" /></li>
</ul>
<p>ç„¶åå®šä¹‰ä¸€ä¸ªåˆ†ç±»ç›®å½•çš„æ ‡ç­¾ï¼š</p>
<pre><code class="python">from django import template
from ..models import Category

register = template.Library()

@register.simple_tag
def get_categories():
    &quot;&quot;&quot;
    åˆ†ç±»ç›®å½•æ ‡ç­¾
    :return:
    &quot;&quot;&quot;
    return Category.objects.all()
</code></pre>

<p>åœ¨å‰ç«¯å¼•ç”¨è‡ªå®šä¹‰æ ‡ç­¾æ—¶ï¼Œä¸€å®šè¦å¼€å¤´åŠ è½½è‡ªå®šä¹‰çš„æ¨¡ç‰ˆæ ‡ç­¾æ‰€åœ¨çš„pyæ–‡ä»¶ï¼Œ<code>{% load simple_tags %}</code>,ç„¶åå†ä½¿ç”¨ï¼š</p>
<pre><code class="html">{% get_categories as category_list %}
{% for category in category_list %}
    &lt;li&gt;&lt;a href=&quot;#&quot;&gt;{{ category.name }}&lt;/a&gt;&lt;/li&gt;
{% endfor %}
</code></pre>

<p>çœ‹ä¸€ä¸‹æ•ˆæœå§ï¼
<img alt="ä¼ä¸šå¾®ä¿¡æˆªå›¾_f1e71885-52fc-43e6-b722-a51dc80c8934.png-364.8kB" src="http://static.zybuluo.com/chuxiaoyi/4i86entcw88n7jzapw847n57/%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_f1e71885-52fc-43e6-b722-a51dc80c8934.png" />
æå®šï¼</p>
<ul>
<li><strong>è¯„è®ºåŠŸèƒ½</strong>
è¯„è®ºåŠŸèƒ½æ–°å»ºä¸€ä¸ªapp</li>
</ul>
<pre><code>./manage.py startapp comment 
</code></pre>

<p>ä¸è¦å¿˜äº†æŠŠå®ƒæ³¨å†Œåˆ°djangoä¸­
<img alt="image_1ckc6rca21j8d73ogvq16a01cl01e.png-15.2kB" src="http://static.zybuluo.com/chuxiaoyi/cjebk0cdfykz15cnb347inx9/image_1ckc6rca21j8d73ogvq16a01cl01e.png" /></p>
<p>åˆ›å»ºæ¨¡å‹ï¼š</p>
<pre><code class="python">from django.db import models

class Comment(models.Model):
    name = models.CharField(max_length=20)
    email = models.EmailField(max_length=50)
    website = models.URLField(blank=True)
    text = models.TextField()
    created_time = models.DateTimeField(auto_now_add=True)

    post = models.ForeignKey('Post.Post', on_delete=True)  # ä¸€ç¯‡æ–‡ç« æœ‰å¤šä¸ªè¯„è®º
</code></pre>

<p>ä¸è¦å¿˜äº†æ³¨å†Œåˆ°adminä¸­å•Šï¼</p>
<pre><code>admin.site.register(Comment)
</code></pre>

<p>æœ€é‡è¦çš„ä¸€æ­¥ã€‚æ•°æ®åº“è¿ç§»å•Šï¼ï¼ï¼</p>
<p>è¿™é‡Œè¦å®ç°çš„æ˜¯ç‚¹å‡»submitæŒ‰é’®ï¼Œä¼šæäº¤è¯„è®º
åœ¨<code>comment/views.py</code>ä¸­æ·»åŠ è§†å›¾ï¼š</p>
<pre><code class="python">from django.shortcuts import render, redirect
from .models import Comment
from Post.models import Post
from django.urls import reverse


def submit_comment(request, pk):
    &quot;&quot;&quot;
    å¤„ç†æäº¤çš„è¯„è®º
    :param request:
    :return:
    &quot;&quot;&quot;
    post = request.POST
    comment = Comment()
    comment.name = post.get(&quot;name&quot;)
    comment.email = post.get('email')
    comment.website = post.get('website')
    comment.text = post.get('message')
    comment.post = Post.objects.get(id=pk)
    comment.save()

    return redirect(reverse('Post:detail', kwargs={&quot;pk&quot;: pk}))
</code></pre>

<p>æ›´æ”¹å‰ç«¯é¡µé¢ä¸­çš„è¯„è®ºéƒ¨åˆ†ï¼š
<img alt="image_1ckcba269rui1u8a8rt1chqulf2r.png-37.9kB" src="http://static.zybuluo.com/chuxiaoyi/f5e47hed0uv3grf7qtdo1w8g/image_1ckcba269rui1u8a8rt1chqulf2r.png" /></p>
<p>åœ¨<code>comment/urls.py</code>ä¸­æ·»åŠ æ˜ å°„ï¼š
<img alt="image_1ckcc3v5apog1quqljj7lrrh21p.png-13.1kB" src="http://static.zybuluo.com/chuxiaoyi/19pzrwbl1kb170pul5v7x023/image_1ckcc3v5apog1quqljj7lrrh21p.png" />
è¯•ä¸€ä¸‹å§ï¼
<img alt="image_1ckcc59nn17vv1dqq1lot1lak8tk26.png-24.9kB" src="http://static.zybuluo.com/chuxiaoyi/jdgsbihsi0hdw5b56idjitl1/image_1ckcc59nn17vv1dqq1lot1lak8tk26.png" />
æå®šï¼</p>
<p><font color='red'><strong>åé¢å†å®Œå–„ä¸€ä¸‹ã€‚ææˆå¯ä»¥å›å¤çš„å•µï¼å°æœ¬æœ¬è®°ä¸‹æ¥ï½</strong></font></p>
<ul>
<li><strong>æœ€æ–°è¯„è®º</strong>
è¿™ä¸ªä¹Ÿå†™æˆè‡ªå®šä¹‰æ ‡ç­¾å•µã€‚</li>
</ul>
<pre><code class="python">@register.simple_tag
def get_latest_comment():
    &quot;&quot;&quot;
    è·å–æœ€æ–°è¯„è®º
    :return:
    &quot;&quot;&quot;
    comment_list = Comment.objects.all()[:5].only('post', 'text')   # åªè·å–ç‰¹å®šå­—æ®µ
    return comment_list
</code></pre>

<p><img alt="image_1ckceclnl10r41ocn18rlu2mpfc2j.png-17.4kB" src="http://static.zybuluo.com/chuxiaoyi/8ls7ecfp6838j3n0e0uzfgfv/image_1ckceclnl10r41ocn18rlu2mpfc2j.png" />
<code>truncatechars</code>å¯ä»¥æˆªå–å­—ç¬¦ä¸²ï¼Œç”¨æ³•ï¼š<code>{{ comment.text | truncatechars:10 }}</code>
çœ‹ä¸€ä¸‹æ•ˆæœ
<img alt="image_1ckcef75i1ie51q421seb1rcu1lmm30.png-20.2kB" src="http://static.zybuluo.com/chuxiaoyi/4688zzma09v6kdfe0dorx8yv/image_1ckcef75i1ie51q421seb1rcu1lmm30.png" />
æå®šï¼</p>
<ul>
<li><strong>é˜…è¯»é‡</strong>
åœ¨<code>Post/models.py</code>ä¸­æ·»åŠ ï¼š
<img alt="image_1ckcf0alj1l1u12a450avgf14323d.png-71.1kB" src="http://static.zybuluo.com/chuxiaoyi/1cm876ipp9l2m0ahh4hrjw1o/image_1ckcf0alj1l1u12a450avgf14323d.png" /></li>
</ul>
<p>åœ¨<code>Post/views.py</code>ä¸­æ·»åŠ ï¼š
<img alt="image_1ckcf1coerbg1j2lroe2l91q9b3q.png-48.6kB" src="http://static.zybuluo.com/chuxiaoyi/8bz7aaw3iqj6lxcx0vkvdgdd/image_1ckcf1coerbg1j2lroe2l91q9b3q.png" /></p>
<p>åœ¨å‰ç«¯é¡µé¢æ·»åŠ ï¼š
<img alt="image_1ckcf2edjfd11i6qg8e1vq51pfo47.png-4.3kB" src="http://static.zybuluo.com/chuxiaoyi/fy60nesb0nih1f8bnt2id1yh/image_1ckcf2edjfd11i6qg8e1vq51pfo47.png" /></p>
<p>æå®šï¼
<img alt="image_1ckcf3k481u62unqtur1iis10ne5k.png-7.5kB" src="http://static.zybuluo.com/chuxiaoyi/z7b8c2kehww2oufikser9o0d/image_1ckcf3k481u62unqtur1iis10ne5k.png" /></p>
<p>å¥½å•¦ï½åˆ°è¿™é‡Œåšå®¢åŸºæœ¬æˆå‹äº†ã€‚å°±æ˜¯ä¸å¥½çœ‹= =ã€‚ç„¶ååé¢ç»§ç»­å®Œå–„ã€‚å°æœ¬æœ¬è®°ä¸‹æ¥ã€‚</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>author by ChuXiaoYi</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
